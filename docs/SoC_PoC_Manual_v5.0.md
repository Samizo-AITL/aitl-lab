# 第0章 PoC設計全体像・AITL対応マニュアル概要

## 0.1 本マニュアルの目的
本マニュアルは、AITL（All-in-Theory Logic）構想に基づくSoC制御系PoC設計の全体像を示し、エンジニアが実務に活用できる体系的な設計指針と実践ノウハウを提供します。

## 0.2 PoC設計全体像とAITL対応
- AITL構想の概要とPoC設計への適用意義
- SoC制御系におけるPoC設計の位置づけ
- ハードウェア（RTL）とソフトウェア（SW）連携の重要性
- 評価・検証・管理の体系的アプローチ

## 0.3 マニュアルの章構成（v5.0版）
本マニュアルは以下の構成により、基礎から応用、実装・検証、出口戦略までを包括的にカバーします。

| 章番号   | 章タイトル                                 | 概要説明                                         |
| -------- | ----------------------------------------- | ------------------------------------------------ |
| 【0】緒言・導入 | 第0章：PoC設計全体像・AITL対応マニュアル概要 | 本マニュアルの目的と全体像紹介                     |
| 【I】基本技術基盤 | 第1章：PoC仕様策定と要件定義（AITL視点）          | AITL視点によるPoC仕様と要件の策定                 |
|          | 第2章：制御系設計の実務ポイント                 | PID制御、PWM、適応制御、現代制御理論の実践知識   |
|          | 第3章：RTL設計のAITL対応実務ポイント             | RTL設計におけるAITL理論適用の実務ポイント         |
|          | 第4章：PDKとファウンドリ選定（AITLと物理整合）     | PDK選定とファウンドリ検討、AITL設計との整合性     |
|          | 第5章：ソフト制御との連携設計（RISC-V上でのAITL連携）| RISC-Vを用いたソフト制御とAITL連携設計            |
| 【II】応用技術展開 | 第6章：センサ混載技術とアナログIF設計（AITL構造反映） | センサ混載・アナログインターフェース設計          |
|          | 第7章：DFT設計とテスト容易化（AITL評価指標含む）     | DFT設計とAITL評価指標を踏まえたテスト容易化        |
|          | 第8章：AI自己修復PoC設計手法（AITL理論適用）        | AIを活用した自己修復設計手法                       |
|          | 第9章：SoC統合と協調設計（ハード＋ソフト＋AITL連携） | ハード・ソフト統合設計とAITLによる協調設計         |
|          | 第10章：PoCプロジェクトの管理と評価（AITL評価体系）  | プロジェクト管理とAITL評価体系、ドキュメント管理    |
|          | 第11章：出口戦略とSystemDK移行設計                 | PoCからSystemDKへの移行設計手法                    |
| 【III】実装・検証 | 第12章：PoC評価の指標とプロジェクト管理（AITL観点）    | PoC評価指標の詳細とプロジェクト管理                |
| 【IV】出口とSystemDK | 第13章：製品化に向けた物理・実装検証                 | SI/PI、熱、応力、EMI/EMCなど物理検証               |
|          | 第14章：外付け・混載デバイスとのインタフェース設計     | 外付け・混載デバイスのインターフェース設計         |
|          | 第15章：SystemDK移行設計とIP再構成戦略（AITL設計資産化）| SystemDKへの設計資産化とIP再構成                    |
|          | 第16章：出口戦略別SystemDK開発方針                   | 出口戦略に応じたSystemDK開発の方針                 |
| 【付録】   | 付録A：設計テンプレート・PoC成果記録フォーマット       | 設計テンプレートや成果記録のフォーマット            |
|          | 付録B：出口戦略別チェックリスト                      | 出口戦略ごとのチェックリスト                         |
|          | 付録C：PoCDK→SystemDK変換事例集                      | PoCDKからSystemDKへ変換した事例集                    |

## 0.4 本マニュアルの利用方法
- 各章は相互に関連しながらも独立した内容として読み進めることが可能です。
- 実際の設計・検証コードは `src/rtl`（ハードウェア）、`src/sw`（ソフトウェア）に分けて管理しています。
- 評価・検証手法は `eval/` に収録し、テンプレートや設計雛形は `templates/` に用意しています。
- 本マニュアルは継続的に更新し、最新のAITL理論・実務に対応させていきます。

---

# 第1章 PoC仕様策定と要件定義（AITL視点）

## 1.1 本章の目的
本章では、SoC制御系PoCにおける仕様策定と要件定義の手順を示し、AITL構想に沿った形での設計出発点を明確化します。PoCの対象スコープ、設計制約、AITL適用範囲を整理することが目的です。

## 1.2 AITL構想に基づく設計出発点
- AITLとは「All-in-Theory Logic」の略であり、設計理論・評価基準・制御哲学を内包する概念。
- AITLは仕様策定段階から「目的関数ベースの制約モデル化」や「最適化指向設計」を重視する。
- 本PoCでは、AITLの観点を用いて以下を定義：
  - 制御対象（plant）のモデル化レベル（抽象/物理/論理）
  - 制御目標の階層（基本制御／協調制御／自己修復）
  - 評価メトリクス（応答性、安定性、効率性）

## 1.3 仕様策定プロセス（AITL対応）
### 1.3.1 設計対象スコープの明確化
- 対象とする制御系の種類：例）DCモーター制御、電源制御、温調制御など
- 制御対象の抽象モデル：状態遷移、入出力、制御則の定義

### 1.3.2 AITLによる要求階層の定義
| 層 | 要求内容の例 | 解説 |
|----|---------------|------|
| L0 | 物理制約     | 電圧・温度・電流などの制限条件 |
| L1 | 機能要件     | 制御性能、動作モード、異常処理 |
| L2 | 構造要件     | モジュール構成、再利用性、分割設計可能性 |
| L3 | 認識／推論要件 | 自己診断、フィードバック適応、信号分類など |

### 1.3.3 AITL PoC仕様記述テンプレート（概要）
```text
[PoC機能名]：例）電流制御モジュール  
[目的関数]：例）目標電流への最小時間応答  
[設計制約]：例）PWM周波数、応答遅れ、発熱限界  
[評価指標]：例）オーバーシュート、定常誤差、制御周期  
[AITL連携]：構造設計との接点、自己修復機構の挿入位置
```

## 1.4 PoC設計における要件定義のチェックポイント

- **環境依存条件の明確化**  
  使用温度範囲、電源電圧、発振器の安定性、外部クロック源の条件など、PoCの運用に影響を及ぼす環境条件を明示する必要があります。

- **非機能要件の明示**  
  機能だけでなく、以下のような非機能的要件も事前に定義することがPoC品質に直結します。  
  例：消費電力上限、物理実装面積、テスト容易性（DFT対応）、FPGAでの一時実装可否など。

- **スケーラビリティと再利用性**  
  設計モジュールが将来的にSystemDKへ移行できるよう、ブロック分割やインタフェース仕様を意識した構造化を初期段階から設計に盛り込みます。


## 1.5 本章まとめ

- **仕様策定はPoC設計の最初かつ最重要フェーズ**であり、AITLの観点から「階層的」「目的関数的」に構造化して進めることが成功の鍵となります。
- **AITLを活用することで、従来の「仕様書記述」から「意味構造ベース設計」へと発展可能**であり、上流段階からPoC設計に知的構造を埋め込むことができます。
- **以降の章では、本章で定義した仕様と要件を基に、ハード・ソフト・評価連携を含む実装プロセスへと展開**していきます。

---

# 第2章 制御系設計の実務ポイント  
（PID、PWM、適応制御、現代制御理論）

## 2.1 本章の目的
本章では、SoCにおける制御系設計を行う上での基本的かつ実践的な知識をまとめます。  
AITL視点からは「目的関数に基づく構造的制御設計」として、制御理論とハードウェア実装を橋渡しします。

## 2.2 制御系設計の基本構造とSoC実装の観点
- 制御ループの構成：センサ入力 → 制御計算 → アクチュエータ出力
- SoC制御系における構成例：ADC → PID計算（SW/RTL）→ PWM出力
- 信号帯域・遅延・分解能・量子化誤差などの影響
- AITL観点：制御モデルの階層性とパラメトリック設計の重要性

## 2.3 PID制御の実装ノウハウ
### 2.3.1 離散時間PID制御の基本式
```math
u[k] = Kp·e[k] + Ki·∑e[k]Δt + Kd·(e[k] - e[k-1])/Δt
```

### 2.3.2 実装上のポイント

- **ADCサンプリング周期と制御周期の一致**  
  制御ループの正確な応答性確保のためには、ADCのサンプリング周期とPID計算周期を一致させる必要があります。

- **積分飽和対策（アンチワインドアップ）**  
  積分動作が飽和して暴走するのを防ぐため、出力制限と積分リセットを導入します。

- **微分ノイズ対策（低通フィルタ付加）**  
  微分項はノイズに敏感なため、LPF（Low Pass Filter）を付加してノイズの影響を低減します。

- **RTL実装と固定小数点の活用例**  
  RTLによるPID制御では、浮動小数点演算の代わりに固定小数点を使用することで、面積と性能のバランスをとります。

---

### 2.3.3 RTL or ソフト設計の分担

| 機能             | 実装対象     | 理由                             |
|------------------|--------------|----------------------------------|
| PID計算          | SWまたはRTL  | 処理負荷と応答速度のバランスを考慮 |
| 積分状態保持     | レジスタ/RAM | 状態管理のため                   |
| ゲイン調整       | SW可変設計   | 現場でのチューニング対応の柔軟性 |

---

## 2.4 PWM制御とデューティ変調

- **PWMの周期、分解能、リップルとの関係**  
  周期が長くなると分解能が上がるが応答遅れが増える。短すぎるとリップルやノイズが増加。

- **位相ずれ・ノイズ抑制設計**  
  複数PWM出力を持つ場合、位相制御でノイズを分散させる設計が重要。

- **カウンタベースPWM回路設計**  
  VerilogによるPWMモジュールは `src/rtl/` に別途記述予定。例：up-downカウンタ型、センターアライナ型など。

- **RISC-VからのPWMパラメータ制御例**  
  レジスタマッピングを通じてPWM周期・デューティ比を制御。制御コードは `src/sw/` に配置。

---

## 2.5 適応制御の導入（モデルベース設計とオンライン更新）

- **モデルの時間変動に対する制御法**  
  外乱や経年変化に応じて制御パラメータをリアルタイムで調整可能な設計。

- **ゲインスケジューリングとパラメータ推定法**  
  動作点に応じて最適なパラメータを事前定義、または推定（オンライン/オフライン）。

- **AI/MLとの連携による「適応則の構造化」**  
  AITL構造において「認識ブロック」との連携を想定し、学習モデルを適応制御則に統合する道筋を整備。

---

## 2.6 現代制御理論とPoC適用の勘所

- **状態空間モデルと可制御性・可観測性**  
  現代制御理論では、可制御性と可観測性がPoCの設計・テスト可能性を左右する。

- **LQR（最適レギュレータ）、H∞制御の実用領域**  
  安定性と応答性を両立させる理論的な制御設計手法。制御対象に応じた選択が必要。

- **ハードウェア実装の際の行列表現の注意点**  
  数値安定性を意識し、演算順序やスケーリング処理に工夫が必要。

- **AITL評価指標としての安定余裕・制御効果指標の構築**  
  制御系の性能をAITL構造に反映し、形式的評価に展開できる指標群を構築。

---

## 2.7 本章まとめ

- **制御設計はPoCにおける機能中心軸**であり、ハードウェアとソフトウェアの適切な分担が求められる。
- **AITLの考え方を導入することで、「構造的」「目的関数駆動型」の制御設計へ発展**させることが可能。
- **次章では、制御構造をRTLに実装するための実務的設計ポイント**を詳述する。

---


